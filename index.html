<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solana Vault – pure web3.js dApp</title>
  <style>
    :root{--bg:#0b0f14;--panel:#121821;--ink:#e6edf3;--muted:#8aa0b4;--danger:#ff7a7a}
    html,body{background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;margin:0}
    header{padding:18px 16px;border-bottom:1px solid #1e2631;background:linear-gradient(180deg,#0e131a,#0b0f14)}
    .wrap{max-width:980px;margin:0 auto;padding:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .card{background:var(--panel);border:1px solid #1e2631;border-radius:12px;padding:16px;margin:12px 0}
    button,select,input,textarea{background:#0f1520;border:1px solid #2a3545;color:var(--ink);padding:10px 12px;border-radius:10px}
    button{cursor:pointer}
    button.danger{border-color:#5a2a2a;background:#241113}
    code.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
    .small{font-size:12px}.muted{color:var(--muted)}.err{color:var(--danger)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .hr{height:1px;background:#1e2631;margin:12px 0}
  </style>
</head>
<body>
  <header>
    <div class="wrap row" style="justify-content:space-between">
      <div class="row" style="gap:10px">
        <strong>Solana Vault (pure web3.js)</strong>
        <span class="small muted">Program: <code id="program-id-short" class="mono">…</code></span>
      </div>
      <div class="row" style="gap:8px">
        <select id="cluster">
          <option value="https://api.devnet.solana.com">Devnet</option>
          <option value="https://api.testnet.solana.com">Testnet</option>
          <option value="https://api.mainnet-beta.solana.com">Mainnet Beta</option>
          <option value="http://localhost:8899">Localhost</option>
        </select>
        <button id="connect">Connect Wallet</button>
      </div>
    </div>
  </header>

  <div class="wrap">
    <div class="card">
      <h2>Connection</h2>
      <div class="small muted">Wallet: <span id="wallet">Not connected</span></div>
      <div class="small muted">Vault PDA: <code id="vault-pda" class="mono">—</code></div>
      <div class="small muted">Status: <span id="status" class="muted">Ready</span></div>
      <div class="small muted">Need SOL on devnet? Use the <a href="https://faucet.solana.com/" target="_blank">faucet</a>.</div>
      <div id="hint-file" class="small err" style="display:none">Open via http(s) (not file://). Phantom doesn’t inject on file:// pages.</div>
    </div>

    <div class="grid">
      <div class="card">
        <h2>Initialize Vault</h2>
        <label class="small muted">Initial members (comma-separated pubkeys)</label><br />
        <textarea id="init-members" rows="3" placeholder="Eg: 7xs…abc, 8Nd…xyz" style="width:100%"></textarea>
        <div class="small muted">PDA seeds: <code class="mono">["vault", owner]</code></div>
        <div class="row" style="margin-top:10px"><button id="btn-init">Initialize</button></div>
        <div class="small" id="init-msg"></div>
      </div>

      <div class="card">
        <h2>Add Member</h2>
        <input id="add-member" placeholder="New member pubkey" style="width:100%" />
        <div class="row" style="margin-top:10px"><button id="btn-add">Add</button></div>
        <div class="small" id="add-msg"></div>
      </div>

      <div class="card">
        <h2>Remove Member</h2>
        <input id="remove-member" placeholder="Member pubkey" style="width:100%" />
        <div class="row" style="margin-top:10px"><button id="btn-remove" class="danger">Remove</button></div>
        <div class="small" id="remove-msg"></div>
      </div>

      <div class="card">
        <h2>Withdraw SOL</h2>
        <input id="withdraw-recipient" placeholder="Recipient pubkey" style="width:100%" />
        <div style="height:8px"></div>
        <input id="withdraw-amount" type="number" min="0" step="1" value="0" style="width:100%" />
        <div class="small muted">Amount in lamports</div>
        <div class="row" style="margin-top:10px"><button id="btn-withdraw">Withdraw</button></div>
        <div class="small" id="withdraw-msg"></div>
      </div>

      <div class="card" style="grid-column:1/-1">
        <h2>Read: Vault Account</h2>
        <div class="row" style="gap:8px"><button id="btn-refresh">Refresh</button></div>
        <div class="hr"></div>
        <div class="small">Owner: <code id="owner" class="mono">—</code></div>
        <div class="small">Bump: <code id="bump" class="mono">—</code></div>
        <div class="small">Members (<span id="members-count">0</span>):</div>
        <ul id="members" class="small"></ul>
      </div>
    </div>
  </div>

  <!-- Only web3.js (no Anchor) -->
  <script src="https://unpkg.com/@solana/web3.js@1.95.1/lib/index.iife.min.js"></script>
  <!-- Polyfill Buffer for browser -->
<script src="https://unpkg.com/buffer@6.0.3/index.js"></script>
<script>
  window.Buffer = buffer.Buffer;
</script>
  <script src="./main.js" defer></script>
</body>
</html>
